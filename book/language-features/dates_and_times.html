<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Dates &amp; Times - PRQL Language Book</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Modern language for transforming data — a simple, powerful, pipelined SQL replacement">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../comparison-table.css">
        <link rel="stylesheet" href="../mdbook-admonish.css">
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../queries/queries.html"><strong aria-hidden="true">2.</strong> Queries</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../queries/pipelines.html"><strong aria-hidden="true">2.1.</strong> Pipelines</a></li><li class="chapter-item expanded "><a href="../queries/functions.html"><strong aria-hidden="true">2.2.</strong> Functions</a></li><li class="chapter-item expanded "><a href="../queries/tables.html"><strong aria-hidden="true">2.3.</strong> Tables</a></li><li class="chapter-item expanded "><a href="../queries/syntax.html"><strong aria-hidden="true">2.4.</strong> Syntax</a></li><li class="chapter-item expanded "><a href="../queries/dialect_and_version.html"><strong aria-hidden="true">2.5.</strong> Dialect & Version</a></li></ol></li><li class="chapter-item expanded "><a href="../transforms.html"><strong aria-hidden="true">3.</strong> Transforms</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../transforms/aggregate.html"><strong aria-hidden="true">3.1.</strong> Aggregate</a></li><li class="chapter-item expanded "><a href="../transforms/derive.html"><strong aria-hidden="true">3.2.</strong> Derive</a></li><li class="chapter-item expanded "><a href="../transforms/filter.html"><strong aria-hidden="true">3.3.</strong> Filter</a></li><li class="chapter-item expanded "><a href="../transforms/from.html"><strong aria-hidden="true">3.4.</strong> From</a></li><li class="chapter-item expanded "><a href="../transforms/group.html"><strong aria-hidden="true">3.5.</strong> Group</a></li><li class="chapter-item expanded "><a href="../transforms/join.html"><strong aria-hidden="true">3.6.</strong> Join</a></li><li class="chapter-item expanded "><a href="../transforms/select.html"><strong aria-hidden="true">3.7.</strong> Select</a></li><li class="chapter-item expanded "><a href="../transforms/sort.html"><strong aria-hidden="true">3.8.</strong> Sort</a></li><li class="chapter-item expanded "><a href="../transforms/take.html"><strong aria-hidden="true">3.9.</strong> Take</a></li><li class="chapter-item expanded "><a href="../transforms/window.html"><strong aria-hidden="true">3.10.</strong> Window</a></li></ol></li><li class="chapter-item expanded "><a href="../language-features/index.html"><strong aria-hidden="true">4.</strong> Language features</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../language-features/coalesce.html"><strong aria-hidden="true">4.1.</strong> Coalesce</a></li><li class="chapter-item expanded "><a href="../language-features/dates_and_times.html" class="active"><strong aria-hidden="true">4.2.</strong> Dates & Times</a></li><li class="chapter-item expanded "><a href="../language-features/distinct.html"><strong aria-hidden="true">4.3.</strong> Distinct</a></li><li class="chapter-item expanded "><a href="../language-features/f-strings.html"><strong aria-hidden="true">4.4.</strong> F-Strings</a></li><li class="chapter-item expanded "><a href="../language-features/null.html"><strong aria-hidden="true">4.5.</strong> Null handling</a></li><li class="chapter-item expanded "><a href="../language-features/ranges.html"><strong aria-hidden="true">4.6.</strong> Ranges</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.7.</strong> Regex</div></li><li class="chapter-item expanded "><a href="../language-features/s-strings.html"><strong aria-hidden="true">4.8.</strong> S-Strings</a></li><li class="chapter-item expanded "><a href="../language-features/strings.html"><strong aria-hidden="true">4.9.</strong> Strings</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.</strong> Stdlib</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> Integrations</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">6.1.</strong> VSCode</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.2.</strong> Jupyter</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.3.</strong> Prefect</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.4.</strong> dbt</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.5.</strong> Rill</div></li></ol></li><li class="chapter-item expanded "><a href="../examples/index.html"><strong aria-hidden="true">7.</strong> Examples</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../examples/variables.html"><strong aria-hidden="true">7.1.</strong> Variables</a></li><li class="chapter-item expanded "><a href="../examples/list-equivalence.html"><strong aria-hidden="true">7.2.</strong> List equivalence</a></li><li class="chapter-item expanded "><a href="../examples/functions.html"><strong aria-hidden="true">7.3.</strong> Functions</a></li><li class="chapter-item expanded "><a href="../examples/cte.html"><strong aria-hidden="true">7.4.</strong> CTE (intermediate tables)</a></li><li class="chapter-item expanded "><a href="../examples/sql-parameters.html"><strong aria-hidden="true">7.5.</strong> SQL parameters</a></li><li class="chapter-item expanded "><a href="../examples/employees.html"><strong aria-hidden="true">7.6.</strong> Employees</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">PRQL Language Book</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/prql/prql" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="dates--times"><a class="header" href="#dates--times">Dates &amp; Times</a></h1>
<p>PRQL uses <code>@</code> followed by a string to represent dates &amp; times. This is less
verbose than SQL’s approach of <code>TIMESTAMP '2004-10-19 10:23:54'</code> and more
explicit than SQL’s implicit option of just using a string <code>'2004-10-19 10:23:54'</code>.</p>
<pre><code class="language-admonish note">Currently PRQL passes strings which can be compiled straight through to the
database, and so many compatible formats string may work, but we may refine this
in the future to aid in compatibility across databases. We'll always support the
canonical [ISO8601](https://en.wikipedia.org/wiki/ISO_8601) format described below.
</code></pre>
<h2 id="dates"><a class="header" href="#dates">Dates</a></h2>
<p>Dates are represented by <code>@{yyyy-mm-dd}</code> — a <code>@</code> followed by the
date format.</p>
<div class="comparison">
<div>
<h4 id="prql"><a class="header" href="#prql">PRQL</a></h4>
<pre><code class="language-prql">from employees
derive age_at_year_end = (@2022-12-31 - dob)
</code></pre>
</div>
<div>
<h4 id="sql"><a class="header" href="#sql">SQL</a></h4>
<pre><code class="language-sql">SELECT
  employees.*,
  DATE '2022-12-31' - dob AS age_at_year_end
FROM
  employees
</code></pre>
</div>
</div>
<h2 id="times"><a class="header" href="#times">Times</a></h2>
<p>Times are represented by <code>@{HH:mm:ss.SSS±Z}</code> with any parts not supplied being
rounded to zero, including the timezone, which is represented by <code>+HH:mm</code>,
<code>-HH:mm</code> or <code>Z</code>. This is consistent with the ISO8601 time format.</p>
<div class="comparison">
<div>
<h4 id="prql-1"><a class="header" href="#prql-1">PRQL</a></h4>
<pre><code class="language-prql">from orders
derive should_have_shipped_today = (order_time &lt; @08:30)
</code></pre>
</div>
<div>
<h4 id="sql-1"><a class="header" href="#sql-1">SQL</a></h4>
<pre><code class="language-sql">SELECT
  orders.*,
  order_time &lt; TIME '08:30' AS should_have_shipped_today
FROM
  orders
</code></pre>
</div>
</div>
<h2 id="timestamps"><a class="header" href="#timestamps">Timestamps</a></h2>
<p>Timestamps are represented by <code>@{yyyy-mm-ddTHH:mm:ss.SSS±Z}</code> /
<code>@{date}T{time}</code>, with any time parts not supplied being rounded to zero,
including the timezone, which is represented by <code>+HH:mm</code>, <code>-HH:mm</code> or <code>Z</code>. This
is <code>@</code> followed by the ISO8601 datetime format, which uses <code>T</code> to separate date &amp;
time.</p>
<div class="comparison">
<div>
<h4 id="prql-2"><a class="header" href="#prql-2">PRQL</a></h4>
<pre><code class="language-prql">derive first_prql_commit = @2020-01-01T13:19:55-0800
</code></pre>
</div>
<div>
<h4 id="sql-2"><a class="header" href="#sql-2">SQL</a></h4>
<pre><code class="language-sql">SELECT
  TIMESTAMP '2020-01-01T13:19:55-0800' AS first_prql_commit
</code></pre>
</div>
</div>
<h2 id="intervals"><a class="header" href="#intervals">Intervals</a></h2>
<p>Intervals are represented by <code>{N}{periods}</code>, such as <code>2years</code> or <code>10minutes</code>,
without a space.</p>
<pre><code class="language-admonish note">These aren't the same as ISO8601, because we evaluated `P3Y6M4DT12H30M5S` to
be difficult to understand, but we could support a simplified form if there's
demand for it. We don't currently support compound expressions, for example
`2years10months`, but most DBs will allow `2years + 10months`. Please raise an
issue if this is inconvenient.
</code></pre>
<div class="comparison">
<div>
<h4 id="prql-3"><a class="header" href="#prql-3">PRQL</a></h4>
<pre><code class="language-prql">from projects
derive first_check_in = start + 10days
</code></pre>
</div>
<div>
<h4 id="sql-3"><a class="header" href="#sql-3">SQL</a></h4>
<pre><code class="language-sql">SELECT
  projects.*,
  start + INTERVAL '10' DAY AS first_check_in
FROM
  projects
</code></pre>
</div>
</div>
<h2 id="examples"><a class="header" href="#examples">Examples</a></h2>
<p>Here’s a fuller list of examples:</p>
<ul>
<li><code>@20221231</code> is forbidden — it must contain full punctuation (<code>-</code> and <code>:</code>),</li>
<li><code>@2022-12-31</code> is a date</li>
<li><code>@2022-12</code> or <code>@2022</code> are forbidden — SQL can’t express a month, only a date</li>
<li><code>@16:54:32.123456</code> is a time</li>
<li><code>@16:54:32</code>, <code>@16:54</code>, <code>@16</code> are all allowed, expressing <code>@16:54:32.000000</code>, <code>@16:54:00.000000</code>, <code>@16:00:00.000000</code> respectively</li>
<li><code>@2022-12-31T16:54:32.123456</code> is a timestamp without timezone</li>
<li><code>@2022-12-31T16:54:32.123456Z</code> is a timestamp in UTC</li>
<li><code>@2022-12-31T16:54+02</code> is timestamp in UTC+2</li>
<li><code>@2022-12-31T16:54+02:00</code> and <code>@2022-12-31T16:54+02</code> are datetimes in UTC+2</li>
<li><code>@16:54+02</code> is forbidden — time is always local, so it cannot have a timezone</li>
<li><code>@2022-12-31+02</code> is forbidden — date is always local, so it cannot have a timezone</li>
</ul>
<h2 id="roadmap"><a class="header" href="#roadmap">Roadmap</a></h2>
<h3 id="datetimes"><a class="header" href="#datetimes">Datetimes</a></h3>
<p>Datetimes are supported by some databases (e.g. MySql, BigQuery) in addition to
timestamps. When we have type annotations, these will be represented by a
timestamp annotated as a datetime:</p>
<pre><code class="language-prql_no_test">derive pi_day = @2017-03-14T15:09:26.535898&lt;datetime&gt;
</code></pre>
<p>These are some examples we can then add:</p>
<ul>
<li><code>@2022-12-31T16:54&lt;datetime&gt;</code> is datetime without timezone</li>
<li><code>@2022-12-31&lt;datetime&gt;</code> is forbidden — datetime must specify time</li>
<li><code>@16:54&lt;datetime&gt;</code> is forbidden — datetime must specify date</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../language-features/coalesce.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../language-features/distinct.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../language-features/coalesce.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../language-features/distinct.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="../highlight-prql.js"></script>
    </body>
</html>
